{"format_version":"1.2","terraform_version":"1.13.3","variables":{"aws_region":{"value":"us-east-1"},"default_tags":{"value":{"env":"sandbox","project":"driftguard"}},"log_expiration_days":{"value":14},"project_prefix":{"value":"driftguard"}},"planned_values":{"outputs":{"aws_partition":{"sensitive":false,"type":"string","value":"aws"},"aws_region":{"sensitive":false,"type":"string","value":"us-east-1"},"cloudtrail_arn":{"sensitive":false},"cloudtrail_name":{"sensitive":false,"type":"string","value":"driftguard-trail"},"config_configuration_recorder_name":{"sensitive":false,"type":"string","value":"driftguard-recorder"},"config_delivery_channel_name":{"sensitive":false,"type":"string","value":"driftguard-delivery-channel"},"guardduty_detector_id":{"sensitive":false},"s3_logs_bucket_arn":{"sensitive":false},"s3_logs_bucket_name":{"sensitive":false},"securityhub_account_arn":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_cloudtrail.main","mode":"managed","type":"aws_cloudtrail","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"advanced_event_selector":[],"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":true,"enable_logging":true,"event_selector":[{"data_resource":[],"exclude_management_event_sources":null,"include_management_events":true,"read_write_type":"All"}],"include_global_service_events":true,"insight_selector":[],"is_multi_region_trail":false,"is_organization_trail":false,"kms_key_id":null,"name":"driftguard-trail","s3_key_prefix":null,"sns_topic_name":null,"tags":{"Name":"driftguard-trail","env":"sandbox","project":"driftguard"},"tags_all":{"Name":"driftguard-trail","env":"sandbox","project":"driftguard"}},"sensitive_values":{"advanced_event_selector":[],"event_selector":[{"data_resource":[]}],"insight_selector":[],"tags":{},"tags_all":{}}},{"address":"aws_config_configuration_recorder.main","mode":"managed","type":"aws_config_configuration_recorder","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"driftguard-recorder","recording_group":[{"all_supported":true,"include_global_resource_types":true,"resource_types":null}]},"sensitive_values":{"recording_group":[{"exclusion_by_resource_types":[],"recording_strategy":[]}],"recording_mode":[]}},{"address":"aws_config_configuration_recorder_status.main","mode":"managed","type":"aws_config_configuration_recorder_status","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"is_enabled":true,"name":"driftguard-recorder"},"sensitive_values":{}},{"address":"aws_config_delivery_channel.main","mode":"managed","type":"aws_config_delivery_channel","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"driftguard-delivery-channel","s3_key_prefix":null,"s3_kms_key_arn":null,"snapshot_delivery_properties":[],"sns_topic_arn":null},"sensitive_values":{"snapshot_delivery_properties":[]}},{"address":"aws_guardduty_detector.main","mode":"managed","type":"aws_guardduty_detector","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"enable":true,"tags":{"Name":"driftguard-guardduty","env":"sandbox","project":"driftguard"},"tags_all":{"Name":"driftguard-guardduty","env":"sandbox","project":"driftguard"}},"sensitive_values":{"datasources":[],"tags":{},"tags_all":{}}},{"address":"aws_iam_role.config","mode":"managed","type":"aws_iam_role","name":"config","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"config.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"driftguard-config-role","path":"/","permissions_boundary":null,"tags":{"Name":"driftguard-config-role","env":"sandbox","project":"driftguard"},"tags_all":{"Name":"driftguard-config-role","env":"sandbox","project":"driftguard"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}},{"address":"aws_iam_role_policy_attachment.config","mode":"managed","type":"aws_iam_role_policy_attachment","name":"config","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AWSConfigRole","role":"driftguard-config-role"},"sensitive_values":{}},{"address":"aws_s3_bucket.logs","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"force_destroy":false,"tags":{"Description":"Log storage for CloudTrail, Config, and other security services","Name":"driftguard-logs","env":"sandbox","project":"driftguard"},"tags_all":{"Description":"Log storage for CloudTrail, Config, and other security services","Name":"driftguard-logs","env":"sandbox","project":"driftguard"},"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}},{"address":"aws_s3_bucket_lifecycle_configuration.logs","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{"date":null,"days":14,"expired_object_delete_marker":false}],"filter":[{"and":[],"object_size_greater_than":null,"object_size_less_than":null,"prefix":"","tag":[]}],"id":"expire-logs","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":"","status":"Enabled","transition":[]}],"timeouts":null,"transition_default_minimum_object_size":"all_storage_classes_128K"},"sensitive_values":{"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{}],"filter":[{"and":[],"tag":[]}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}]}},{"address":"aws_s3_bucket_ownership_controls.logs","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"rule":[{"object_ownership":"BucketOwnerEnforced"}]},"sensitive_values":{"rule":[{}]}},{"address":"aws_s3_bucket_policy.logs","mode":"managed","type":"aws_s3_bucket_policy","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"sensitive_values":{}},{"address":"aws_s3_bucket_public_access_block.logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"sensitive_values":{}},{"address":"aws_s3_bucket_server_side_encryption_configuration.logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"bucket_key_enabled":null}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"aws_securityhub_account.main","mode":"managed","type":"aws_securityhub_account","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"auto_enable_controls":true,"enable_default_standards":false},"sensitive_values":{}},{"address":"aws_securityhub_standards_subscription.foundational","mode":"managed","type":"aws_securityhub_standards_subscription","name":"foundational","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"standards_arn":"arn:aws:securityhub:us-east-1::standards/aws-foundational-security-best-practices/v/1.0.0","timeouts":null},"sensitive_values":{}},{"address":"random_id.suffix","mode":"managed","type":"random_id","name":"suffix","provider_name":"registry.terraform.io/hashicorp/random","schema_version":0,"values":{"byte_length":4,"keepers":null,"prefix":null},"sensitive_values":{}}]}},"resource_changes":[{"address":"aws_cloudtrail.main","mode":"managed","type":"aws_cloudtrail","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"advanced_event_selector":[],"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":true,"enable_logging":true,"event_selector":[{"data_resource":[],"exclude_management_event_sources":null,"include_management_events":true,"read_write_type":"All"}],"include_global_service_events":true,"insight_selector":[],"is_multi_region_trail":false,"is_organization_trail":false,"kms_key_id":null,"name":"driftguard-trail","s3_key_prefix":null,"sns_topic_name":null,"tags":{"Name":"driftguard-trail","env":"sandbox","project":"driftguard"},"tags_all":{"Name":"driftguard-trail","env":"sandbox","project":"driftguard"}},"after_unknown":{"advanced_event_selector":[],"arn":true,"event_selector":[{"data_resource":[]}],"home_region":true,"id":true,"insight_selector":[],"s3_bucket_name":true,"sns_topic_arn":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"advanced_event_selector":[],"event_selector":[{"data_resource":[]}],"insight_selector":[],"tags":{},"tags_all":{}}}},{"address":"aws_config_configuration_recorder.main","mode":"managed","type":"aws_config_configuration_recorder","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"driftguard-recorder","recording_group":[{"all_supported":true,"include_global_resource_types":true,"resource_types":null}]},"after_unknown":{"id":true,"recording_group":[{"exclusion_by_resource_types":true,"recording_strategy":true}],"recording_mode":true,"role_arn":true},"before_sensitive":false,"after_sensitive":{"recording_group":[{"exclusion_by_resource_types":[],"recording_strategy":[]}],"recording_mode":[]}}},{"address":"aws_config_configuration_recorder_status.main","mode":"managed","type":"aws_config_configuration_recorder_status","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"is_enabled":true,"name":"driftguard-recorder"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_config_delivery_channel.main","mode":"managed","type":"aws_config_delivery_channel","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"driftguard-delivery-channel","s3_key_prefix":null,"s3_kms_key_arn":null,"snapshot_delivery_properties":[],"sns_topic_arn":null},"after_unknown":{"id":true,"s3_bucket_name":true,"snapshot_delivery_properties":[]},"before_sensitive":false,"after_sensitive":{"snapshot_delivery_properties":[]}}},{"address":"aws_guardduty_detector.main","mode":"managed","type":"aws_guardduty_detector","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"enable":true,"tags":{"Name":"driftguard-guardduty","env":"sandbox","project":"driftguard"},"tags_all":{"Name":"driftguard-guardduty","env":"sandbox","project":"driftguard"}},"after_unknown":{"account_id":true,"arn":true,"datasources":true,"finding_publishing_frequency":true,"id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"datasources":[],"tags":{},"tags_all":{}}}},{"address":"aws_iam_role.config","mode":"managed","type":"aws_iam_role","name":"config","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"config.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"driftguard-config-role","path":"/","permissions_boundary":null,"tags":{"Name":"driftguard-config-role","env":"sandbox","project":"driftguard"},"tags_all":{"Name":"driftguard-config-role","env":"sandbox","project":"driftguard"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}}},{"address":"aws_iam_role_policy_attachment.config","mode":"managed","type":"aws_iam_role_policy_attachment","name":"config","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AWSConfigRole","role":"driftguard-config-role"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket.logs","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"force_destroy":false,"tags":{"Description":"Log storage for CloudTrail, Config, and other security services","Name":"driftguard-logs","env":"sandbox","project":"driftguard"},"tags_all":{"Description":"Log storage for CloudTrail, Config, and other security services","Name":"driftguard-logs","env":"sandbox","project":"driftguard"},"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}}},{"address":"aws_s3_bucket_lifecycle_configuration.logs","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{"date":null,"days":14,"expired_object_delete_marker":false}],"filter":[{"and":[],"object_size_greater_than":null,"object_size_less_than":null,"prefix":"","tag":[]}],"id":"expire-logs","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":"","status":"Enabled","transition":[]}],"timeouts":null,"transition_default_minimum_object_size":"all_storage_classes_128K"},"after_unknown":{"bucket":true,"expected_bucket_owner":true,"id":true,"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{}],"filter":[{"and":[],"tag":[]}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{}],"filter":[{"and":[],"tag":[]}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}]}}},{"address":"aws_s3_bucket_ownership_controls.logs","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"rule":[{"object_ownership":"BucketOwnerEnforced"}]},"after_unknown":{"bucket":true,"id":true,"rule":[{}]},"before_sensitive":false,"after_sensitive":{"rule":[{}]}}},{"address":"aws_s3_bucket_policy.logs","mode":"managed","type":"aws_s3_bucket_policy","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_public_access_block.logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_s3_bucket_server_side_encryption_configuration.logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"AES256"}],"bucket_key_enabled":null}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"aws_securityhub_account.main","mode":"managed","type":"aws_securityhub_account","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_enable_controls":true,"enable_default_standards":false},"after_unknown":{"arn":true,"control_finding_generator":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_securityhub_standards_subscription.foundational","mode":"managed","type":"aws_securityhub_standards_subscription","name":"foundational","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"standards_arn":"arn:aws:securityhub:us-east-1::standards/aws-foundational-security-best-practices/v/1.0.0","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"random_id.suffix","mode":"managed","type":"random_id","name":"suffix","provider_name":"registry.terraform.io/hashicorp/random","change":{"actions":["create"],"before":null,"after":{"byte_length":4,"keepers":null,"prefix":null},"after_unknown":{"b64_std":true,"b64_url":true,"dec":true,"hex":true,"id":true},"before_sensitive":false,"after_sensitive":{}}}],"output_changes":{"aws_partition":{"actions":["create"],"before":null,"after":"aws","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"aws_region":{"actions":["create"],"before":null,"after":"us-east-1","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"cloudtrail_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"cloudtrail_name":{"actions":["create"],"before":null,"after":"driftguard-trail","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"config_configuration_recorder_name":{"actions":["create"],"before":null,"after":"driftguard-recorder","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"config_delivery_channel_name":{"actions":["create"],"before":null,"after":"driftguard-delivery-channel","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"guardduty_detector_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"s3_logs_bucket_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"s3_logs_bucket_name":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"securityhub_account_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.13.3","values":{"outputs":{"aws_partition":{"sensitive":false,"value":"aws","type":"string"},"aws_region":{"sensitive":false,"value":"us-east-1","type":"string"},"cloudtrail_name":{"sensitive":false,"value":"driftguard-trail","type":"string"},"config_configuration_recorder_name":{"sensitive":false,"value":"driftguard-recorder","type":"string"},"config_delivery_channel_name":{"sensitive":false,"value":"driftguard-delivery-channel","type":"string"}},"root_module":{"resources":[{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"516541255674","arn":"arn:aws:iam::516541255674:user/driftguard-admin","id":"516541255674","user_id":"AIDAXQRCCB75CDN26W6U6"},"sensitive_values":{}},{"address":"data.aws_partition.current","mode":"data","type":"aws_partition","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"dns_suffix":"amazonaws.com","id":"aws","partition":"aws","reverse_dns_prefix":"com.amazonaws"},"sensitive_values":{}},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"US East (N. Virginia)","endpoint":"ec2.us-east-1.amazonaws.com","id":"us-east-1","name":"us-east-1"},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"\u003e= 5.0.0","expressions":{"default_tags":[{"tags":{"references":["var.default_tags"]}}],"region":{"references":["var.aws_region"]}}},"random":{"name":"random","full_name":"registry.terraform.io/hashicorp/random","version_constraint":"\u003e= 3.1.0"}},"root_module":{"outputs":{"aws_partition":{"expression":{"references":["data.aws_partition.current.partition","data.aws_partition.current"]},"description":"AWS partition (aws, aws-cn, aws-us-gov)"},"aws_region":{"expression":{"references":["data.aws_region.current.name","data.aws_region.current"]},"description":"AWS region where resources are deployed"},"cloudtrail_arn":{"expression":{"references":["aws_cloudtrail.main.arn","aws_cloudtrail.main"]},"description":"ARN of the CloudTrail trail"},"cloudtrail_name":{"expression":{"references":["aws_cloudtrail.main.name","aws_cloudtrail.main"]},"description":"Name of the CloudTrail trail"},"config_configuration_recorder_name":{"expression":{"references":["aws_config_configuration_recorder.main.name","aws_config_configuration_recorder.main"]},"description":"Name of the AWS Config configuration recorder"},"config_delivery_channel_name":{"expression":{"references":["aws_config_delivery_channel.main.name","aws_config_delivery_channel.main"]},"description":"Name of the AWS Config delivery channel"},"guardduty_detector_id":{"expression":{"references":["aws_guardduty_detector.main.id","aws_guardduty_detector.main"]},"description":"ID of the GuardDuty detector"},"s3_logs_bucket_arn":{"expression":{"references":["aws_s3_bucket.logs.arn","aws_s3_bucket.logs"]},"description":"ARN of the S3 bucket used for logs"},"s3_logs_bucket_name":{"expression":{"references":["aws_s3_bucket.logs.bucket","aws_s3_bucket.logs"]},"description":"Name of the S3 bucket used for logs"},"securityhub_account_arn":{"expression":{"references":["aws_securityhub_account.main.arn","aws_securityhub_account.main"]},"description":"ARN of the Security Hub account"}},"resources":[{"address":"aws_cloudtrail.main","mode":"managed","type":"aws_cloudtrail","name":"main","provider_config_key":"aws","expressions":{"enable_log_file_validation":{"constant_value":true},"event_selector":[{"include_management_events":{"constant_value":true},"read_write_type":{"constant_value":"All"}}],"include_global_service_events":{"constant_value":true},"is_multi_region_trail":{"constant_value":false},"name":{"references":["var.project_prefix"]},"s3_bucket_name":{"references":["aws_s3_bucket.logs.bucket","aws_s3_bucket.logs"]},"tags":{"references":["var.default_tags","var.project_prefix"]}},"schema_version":1,"depends_on":["aws_s3_bucket_policy.logs"]},{"address":"aws_config_configuration_recorder.main","mode":"managed","type":"aws_config_configuration_recorder","name":"main","provider_config_key":"aws","expressions":{"name":{"references":["var.project_prefix"]},"recording_group":[{"all_supported":{"constant_value":true},"include_global_resource_types":{"constant_value":true}}],"role_arn":{"references":["aws_iam_role.config.arn","aws_iam_role.config"]}},"schema_version":0},{"address":"aws_config_configuration_recorder_status.main","mode":"managed","type":"aws_config_configuration_recorder_status","name":"main","provider_config_key":"aws","expressions":{"is_enabled":{"constant_value":true},"name":{"references":["aws_config_configuration_recorder.main.name","aws_config_configuration_recorder.main"]}},"schema_version":0,"depends_on":["aws_config_delivery_channel.main"]},{"address":"aws_config_delivery_channel.main","mode":"managed","type":"aws_config_delivery_channel","name":"main","provider_config_key":"aws","expressions":{"name":{"references":["var.project_prefix"]},"s3_bucket_name":{"references":["aws_s3_bucket.logs.bucket","aws_s3_bucket.logs"]}},"schema_version":0},{"address":"aws_guardduty_detector.main","mode":"managed","type":"aws_guardduty_detector","name":"main","provider_config_key":"aws","expressions":{"enable":{"constant_value":true},"tags":{"references":["var.default_tags","var.project_prefix"]}},"schema_version":0},{"address":"aws_iam_role.config","mode":"managed","type":"aws_iam_role","name":"config","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["var.project_prefix"]},"tags":{"references":["var.default_tags","var.project_prefix"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.config","mode":"managed","type":"aws_iam_role_policy_attachment","name":"config","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AWSConfigRole"},"role":{"references":["aws_iam_role.config.name","aws_iam_role.config"]}},"schema_version":0},{"address":"aws_s3_bucket.logs","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["var.project_prefix","random_id.suffix.hex","random_id.suffix"]},"tags":{"references":["var.default_tags","var.project_prefix"]}},"schema_version":0},{"address":"aws_s3_bucket_lifecycle_configuration.logs","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"rule":[{"expiration":[{"days":{"references":["var.log_expiration_days"]}}],"filter":[{"prefix":{"constant_value":""}}],"id":{"constant_value":"expire-logs"},"status":{"constant_value":"Enabled"}}]},"schema_version":1},{"address":"aws_s3_bucket_ownership_controls.logs","mode":"managed","type":"aws_s3_bucket_ownership_controls","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"rule":[{"object_ownership":{"constant_value":"BucketOwnerEnforced"}}]},"schema_version":0},{"address":"aws_s3_bucket_policy.logs","mode":"managed","type":"aws_s3_bucket_policy","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"policy":{"references":["aws_s3_bucket.logs.arn","aws_s3_bucket.logs","data.aws_caller_identity.current.account_id","data.aws_caller_identity.current","aws_s3_bucket.logs.arn","aws_s3_bucket.logs","aws_s3_bucket.logs.arn","aws_s3_bucket.logs","aws_s3_bucket.logs.arn","aws_s3_bucket.logs"]}},"schema_version":0,"depends_on":["aws_s3_bucket_public_access_block.logs"]},{"address":"aws_s3_bucket_public_access_block.logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.logs","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]},"schema_version":0},{"address":"aws_securityhub_account.main","mode":"managed","type":"aws_securityhub_account","name":"main","provider_config_key":"aws","expressions":{"enable_default_standards":{"constant_value":false}},"schema_version":1},{"address":"aws_securityhub_standards_subscription.foundational","mode":"managed","type":"aws_securityhub_standards_subscription","name":"foundational","provider_config_key":"aws","expressions":{"standards_arn":{"references":["data.aws_partition.current.partition","data.aws_partition.current","data.aws_region.current.name","data.aws_region.current"]}},"schema_version":0,"depends_on":["aws_securityhub_account.main"]},{"address":"random_id.suffix","mode":"managed","type":"random_id","name":"suffix","provider_config_key":"random","expressions":{"byte_length":{"constant_value":4}},"schema_version":0},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_partition.current","mode":"data","type":"aws_partition","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_config_key":"aws","schema_version":0}],"variables":{"aws_region":{"default":"us-east-1","description":"AWS region for resources"},"default_tags":{"default":{"env":"sandbox","project":"driftguard"},"description":"Default tags to apply to all resources"},"log_expiration_days":{"default":14,"description":"Number of days to retain logs in S3"},"project_prefix":{"default":"driftguard","description":"Prefix for resource names"}}}},"relevant_attributes":[{"resource":"data.aws_partition.current","attribute":["partition"]},{"resource":"aws_securityhub_account.main","attribute":["arn"]},{"resource":"aws_config_configuration_recorder.main","attribute":["name"]},{"resource":"aws_iam_role.config","attribute":["name"]},{"resource":"aws_guardduty_detector.main","attribute":["id"]},{"resource":"data.aws_region.current","attribute":["name"]},{"resource":"aws_cloudtrail.main","attribute":["arn"]},{"resource":"aws_cloudtrail.main","attribute":["name"]},{"resource":"aws_config_delivery_channel.main","attribute":["name"]},{"resource":"aws_s3_bucket.logs","attribute":["arn"]},{"resource":"aws_iam_role.config","attribute":["arn"]},{"resource":"data.aws_caller_identity.current","attribute":["account_id"]},{"resource":"random_id.suffix","attribute":["hex"]},{"resource":"aws_s3_bucket.logs","attribute":["bucket"]},{"resource":"aws_s3_bucket.logs","attribute":["id"]}],"timestamp":"2025-10-06T00:54:56Z","applyable":true,"complete":true,"errored":false}
